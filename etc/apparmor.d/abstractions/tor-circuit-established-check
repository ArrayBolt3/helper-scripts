  #include <abstractions/base>
  #include <abstractions/python>

  ## AVC apparmor="DENIED" operation="capable" profile="/usr/bin/tor-circuit-established-check" comm="tor-circuit-est" capability=1  capname="dac_override"
  ## AVC apparmor="DENIED" operation="capable" profile="/usr/bin/tor-circuit-established-check" comm="sh" capability=2  capname="dac_read_search"
  capability dac_override,
  capability dac_read_search,

  ptrace (read),

  /usr/bin/tor-circuit-established-check r,

  / r,
  /{,usr/}bin/ r,
  /{,usr/}bin/ps rix,
  /{,usr/}bin/dash rix,
  /{,usr/}bin/uname rix,

  ## Can probably add keyword `owner` when this abstraction is no longer
  ## required.
  @{PROC}/*/fd/ r,
  @{PROC}/*/stat r,
  @{PROC}/*/mounts r,
  @{PROC}/*/status r,

  @{PROC}/ r,
  @{PROC}/uptime r,
  @{PROC}/sys/kernel/osrelease r,

  /run/tor/control.authcookie r,
